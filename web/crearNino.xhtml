<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Matrícula de Niño</title>
</h:head>
<h:body>

<h:form enctype="multipart/form-data">
    <h:messages globalOnly="true" style="color:red;" />

    <h2>Datos del Padre Registrado</h2>
    <h:panelGroup rendered="#{ninoBean.padreDisponible}">
        <h:panelGrid columns="2" columnClasses="label,value" styleClass="resumen-padre">
            <h:outputLabel value="ID Padre:" />
            <h:outputText value="#{ninoBean.padreIdSeleccionado}" />

            <h:outputLabel value="Nombres:" />
            <h:outputText value="#{ninoBean.usuarioPadreSeleccionado.nombres} #{ninoBean.usuarioPadreSeleccionado.apellidos}" />

            <h:outputLabel value="Documento:" />
            <h:outputText value="#{ninoBean.usuarioPadreSeleccionado.documento}" />

            <h:outputLabel value="Correo:" />
            <h:outputText value="#{ninoBean.usuarioPadreSeleccionado.correo}" />

            <h:outputLabel value="Teléfono:" />
            <h:outputText value="#{ninoBean.usuarioPadreSeleccionado.telefono}" />

            <h:outputLabel value="Dirección:" />
            <h:outputText value="#{ninoBean.usuarioPadreSeleccionado.direccion}" />

            <h:outputLabel value="Ocupación:" />
            <h:outputText value="#{ninoBean.padreSeleccionado.ocupacion}" />

            <h:outputLabel value="Estrato:" />
            <h:outputText value="#{ninoBean.padreSeleccionado.estrato}" />

            <h:outputLabel value="Contacto emergencia:" />
            <h:outputText value="#{ninoBean.padreSeleccionado.nombreContactoEmergencia} / #{ninoBean.padreSeleccionado.telefonoContactoEmergencia}" />

            <h:outputLabel value="Situación económica:" />
            <h:outputText value="#{ninoBean.padreSeleccionado.situacionEconomicaHogar}" />

            <h:outputLabel value="Documento identidad:" />
            <h:panelGroup>
                <h:graphicImage value="#{facesContext.externalContext.requestContextPath}/uploads/#{ninoBean.padreSeleccionado.documentoIdentidadImg}"
                                width="120" height="120" rendered="#{not empty ninoBean.padreSeleccionado.documentoIdentidadImg}" />
                <h:outputText value="No disponible" rendered="#{empty ninoBean.padreSeleccionado.documentoIdentidadImg}" />
            </h:panelGroup>
        </h:panelGrid>
    </h:panelGroup>
    <h:panelGroup rendered="#{!ninoBean.padreDisponible}" style="color:#c0392b; font-weight:bold;">
        <h:outputText value="Debes registrar primero los datos del padre antes de matricular al niño." />
        <br/>
        <h:link outcome="crearPadre" value="Registrar datos del padre" />
    </h:panelGroup>

    <h:inputHidden value="#{ninoBean.padreIdSeleccionado}" />

    <p:separator/>

    <h2>Datos del Niño</h2>
    <h:panelGrid columns="2" columnClasses="label,value">

        <h:outputLabel for="nombresN" value="Nombres:" />
        <h:inputText id="nombresN" value="#{ninoBean.nino.nombres}" required="true" />

        <h:outputLabel for="apellidosN" value="Apellidos:" />
        <h:inputText id="apellidosN" value="#{ninoBean.nino.apellidos}" required="true" />

        <h:outputLabel for="documentoN" value="Documento:" />
        <h:inputText id="documentoN" value="#{ninoBean.nino.documento}" />

        <h:outputLabel for="fechaNac" value="Fecha de nacimiento:" />
        <div class="form-field">
            <h:outputLabel for="fechaNac" value="Fecha de nacimiento" styleClass="field-label"/>
            <p:calendar id="fechaNac"
                        value="#{ninoBean.nino.fechaNacimiento}"
                        pattern="yyyy-MM-dd"
                        navigator="true"
                        yearRange="1950:2100"
                        required="true"
                        requiredMessage="Selecciona la fecha de nacimiento."
                        inputStyleClass="input-field"/>
            <h:message for="fechaNac" styleClass="error-msg"/>
        </div>

        <h:outputLabel for="genero" value="Género:" />
        <h:selectOneMenu id="genero" value="#{ninoBean.nino.genero}">
            <f:selectItem itemLabel="Seleccione..." itemValue="" />
            <f:selectItem itemLabel="Masculino" itemValue="masculino" />
            <f:selectItem itemLabel="Femenino" itemValue="femenino" />
            <f:selectItem itemLabel="Otro" itemValue="otro" />
            <f:selectItem itemLabel="No especificado" itemValue="no_especificado" />
        </h:selectOneMenu>

        <h:outputLabel for="nacionalidad" value="Nacionalidad:" />
        <h:inputText id="nacionalidad" value="#{ninoBean.nino.nacionalidad}" />

        <h:outputLabel for="hogar" value="Hogar comunitario:" />
        <h:selectOneMenu id="hogar" value="#{ninoBean.nino.hogarId}" required="true">
            <f:selectItem itemLabel="Seleccione un hogar..." itemValue="" noSelectionOption="true"/>
            <f:selectItems value="#{ninoBean.listaHogares}" var="h"
                           itemValue="#{h.idHogar}"
                           itemLabel="#{h.nombreHogar} - #{h.localidad}" />
        </h:selectOneMenu>

        <h:outputLabel for="fotoNino" value="Foto del niño:" />
        <h:inputFile id="fotoNino" value="#{ninoBean.fotoNinoPart}" required="true" />

    </h:panelGrid>

    <p:separator/>

    <p:commandButton value="Guardar Matrícula"
                     action="#{ninoBean.guardarMatricula}"
                     ajax="false"
                     styleClass="ui-button-success"
                     disabled="#{!ninoBean.padreDisponible}"/>

    <p:commandButton value="Cancelar" immediate="true"
                     action="#{ninoBean.cancelar}"
                     styleClass="ui-button-secondary"/>

</h:form>

</h:body>
</html>
